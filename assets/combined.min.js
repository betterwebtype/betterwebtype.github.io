function getParameterByName(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}function startGame(){score=0,outOf=0,level=-1,-1==attempt?($(".triangle-game").fadeOut(),setTimeout(function(){$(".instructions").fadeIn()},1e3),setTimeout(function(){$(".instructions .start").addClass("animated infinite pulse")},5e3),attempt++):(attempt++,$(".instructions").fadeOut(),console.log("Attempt:"+attempt),$("#userScore").html(score),setTimeout(function(){$(".outOf").html(outOf)},1200),$("#triangleBg").attr("stroke","#353D44").removeClass("glow"),$("#triangle").attr("stroke","#F15D64"),loadLevel())}function loadLevel(){$("body").removeClass("hide-overflow"),$("#next-level").fadeOut(),$("#tryAgain").fadeOut(),$(".book-msg").fadeOut(),$(".form-triangle").fadeOut(),setTimeout(function(){$(".score").fadeOut(),$("#score").css("color","#fff"),$(".tweet-score .btn-tweet").remove()},1200),$(".tweet-score").fadeOut(),$(".slider").remove(),$("text.fs, text.lw, text.lh").attr("opacity",.4),level++,maxScore=levels[level].maxScore,$("#level-id").html(levels[level].id),$("#instructions").html(levels[level].instructions),$("#font").val(levels[level].font);var a=levels[level].iv[0],b=levels[level].iv[1],c=levels[level].iv[2],d=levels[level].font+", "+levels[level].fallbackFont;for($(".result").css({"line-height":a+"rem",width:b+"px","font-size":c+"px","font-family":d}),i=0;i<3;i++){var e,f,g=levels[level].parameters[i].id,h="#"+g;"lh"!=g?$(h).val(levels[level].iv[i]+"px"):$(h).val(levels[level].iv[i]),levels[level].parameters[i].adjust&&(multiplier=levels[level].parameters[i].values[2],$(h).after('<div class="slider slider-'+levels[level].parameters[i].id+'"></div>'),e=levels[level].parameters[i].values,f=".slider-"+g,$(f).slider({value:levels[level].iv[i],min:e[0],max:e[1],step:e[2],change:function(a,b){0==level&&($("#check").addClass("animated fadeInUpBig"),$(".ui-slider-handle").removeClass("animated infinite pulse"))}})),0==level&&$(".ui-slider-handle").addClass("animated infinite pulse")}$(".slider-lh").slider({slide:function(a,b){$("#lh").val(b.value),$(".result").css("line-height",b.value)}}),$(".slider-lw").slider({slide:function(a,b){$("#lw").val(b.value+"px"),$(".result").css("width",b.value)}}),$(".slider-fs").slider({slide:function(a,b){$("#fs").val(b.value+"px"),$(".result").css("font-size",b.value)}}),$(".level").fadeIn()}function checkScore(){function a(){$(".anim").removeClass("fadeOutUpBig").addClass("animated"),setTimeout(function(){$(".counter").each(function(){var a=$(this),b=a.attr("data-count");$({countNum:a.text()}).animate({countNum:b},{duration:u,easing:"linear",step:function(){a.text(Math.floor(this.countNum))},complete:function(){a.text(this.countNum)}})})},2e3)}$("body").addClass("hide-overflow");var b,c=levels[level].piq,d=levels[level].cv[c],e=$(".slider").slider("option","value"),f=Math.abs(d-e),g=Math.round((d-e)/multiplier);b=f/multiplier<maxScore?Math.round(maxScore-f/multiplier):0;var h,i,j="#24D7D1",k="#EAD079",l="#F15D64";5==maxScore?maxScore-b==0?(h="Perfect!",i=j):maxScore-b==1?(h="Well done",i=j):maxScore-b==2?(h="Not bad",i=k):maxScore-b==3?(h="Could be better",i=k):maxScore-b==4?(h="Way off",i=l):maxScore-b>=5&&(h="Not even close",i=l):10!=maxScore&&15!=maxScore||(maxScore-b==0?(h="Perfect!",i=j):maxScore-b>=10?(h="Way off!",i=l):maxScore-b>=7?(h="Could be better",i=l):maxScore-b>=5?(h="Not quite there",i=k):maxScore-b>=3?(h="Not bad",i=k):maxScore-b>=1&&(h="Well done",i=j)),score+=b,outOf+=maxScore,$(".scoreMsg").html(h),setTimeout(function(){$("#userScore").html(score),$(".outOf").html(outOf)},1e3),triangleResult=0==c?g/2*10:2==c?-10*g:(e-d)/2,0==c||2==c?Math.abs(triangleResult)>60&&triangleResult<0?triangleResult=-60:triangleResult>60&&(triangleResult=60):Math.abs(triangleResult)>30&&triangleResult<0?triangleResult=-30:triangleResult>30&&(triangleResult=30);var m,n=document.getElementById("triangleAnimation"),o=document.getElementById("triangle"),p=levels[level].parameters[c].id,q=300+10*Math.abs(triangleResult)+"ms";if(o.setAttribute("points","150,23 207,111 93,111"),$("text."+p).attr("opacity",1),0==triangleResult)n.setAttribute("to","150,23 207,111 93,111"),setTimeout(function(){$("#triangleId").addClass("animated pulse2")},2e3),setTimeout(function(){$("#triangleId").removeClass("animated pulse2")},3e3);else if(1!=c){var r=150+triangleResult;setTimeout(function(){m=r+",23 207,111 93,111",n.setAttribute("to",m),n.setAttribute("dur",q),o.setAttribute("points",m)},2e3)}else{var s=207+triangleResult,t=93-triangleResult;setTimeout(function(){m="150, 23 "+s+",111 "+t+", 111",n.setAttribute("to",m),n.setAttribute("dur",q),o.setAttribute("points",m)},2e3)}setTimeout(function(){n.beginElement()},2e3),$(".score h1").html("Level "+levels[level].id),$("#score").html("<span class='counter' data-count='"+b+"'>0</span>/"+maxScore).css("color",i),$(".score hr").show();var u=300+10*Math.abs(triangleResult);if($(".score").fadeIn(),a(),level<numOfLevels-1)setTimeout(function(){$("#next-level").fadeIn()},4e3);else{setTimeout(function(){$(".score-content").fadeOut()},4e3);var v,w,x;score<=50?(v="#CD7F32",i=l,w="Oops, you seem to be a",x="Type newbie"):score<=85?(v="#E8E8E2",i=k,w="Not bad, you’re a",x="Type geek wannabe"):(v="#FFC300",i=j,w="Well done you’re a",x="Proper type geek");var y;y=null!=varId?"<table><tbody><tr><td><img src='assets/images/better-web-type-book-cover-small.jpg' width='119'></td><td><h2>Get a chance to win a free <span>Better Web Type</span> book</h2><p><em>All you have to do is tweet your best score. The higher the score, the better the chance to win the free book.</em></p></td></tr></tbody></table>":"<table><tbody><tr><td><img src='assets/images/better-web-type-book-cover-small.jpg' width='119'></td><td><h2>Get a chance to win the book <span>join Better Web Type</span></h2><p><em>You’ll get an occasional newsletter about producing better web typography and access to a free email course.</em></p></td></tr></tbody></table>",setTimeout(function(){o.setAttribute("points","150,23 207,111 93,111"),n.setAttribute("to","150,23 207,111 93,111"),$(".score hr").hide(),$("#triangleBg").attr("stroke",v).addClass("glow"),$("#triangle").attr("stroke",v),$("svg text").attr("opacity",0),$(".score-content h1").html(w),$(".scoreMsg").html(x),$("#score").html("<span class='counter' data-count='"+score+"'>0</span>/"+outOf).css("color",i),$("#final-score").html(score),$(".outOf").html(outOf),$(".score-content").show(),$(".book-msg").html(y),a()},4500);setTimeout(function(){$("#tryAgain").fadeIn()},8e3),score>userTopScore&&(userTopScore=score),$("#ATTEMPT").val(attempt),$("#TOPSCORE").val(userTopScore),console.log("Top score: "+userTopScore)}}!function(a,b){"use strict";$(b).on("submit","form",function(b){var c=$(this);return $.ajax({type:"GET",url:"https://betterwebtype.us2.list-manage2.com/subscribe/post-json?c=?",data:c.serialize(),dataType:"json",contentType:"application/json; charset=utf-8",error:function(a){console.log("error"),$("#msgContent").html('<h3>Oops!</h3><p>Something went wrong, please try again later. Get in touch if the problem persists. <a href="http://twitter.com/matejlatin">@matejlatin</a></p>'),$("#msg").fadeIn(300)},success:function(b){if("success"!=b.result){var c=b.msg,d=c.replace("0 -","");$("#msgContent").html("<h3>Oops!</h3><p>"+d+"</p>"),$("#msg").fadeIn(300)}else a.location.href="almost-finished.html";$("#btnClose").on("click",function(){$("#msg").fadeOut(300),$("#msgContent").removeClass().addClass("animated zoomOut")})}}),!1}),$("#link-contact").on("click",function(){$("#msg").fadeIn(300),$("body").addClass("no-scroll"),$(".curtain").removeClass("show-overflow"),$.get("contact.html",function(a){$("#msgContent").empty().append(a).removeClass().addClass("animated zoomIn")})}),$("#link-privacy").on("click",function(){$("body").addClass("no-scroll"),$(".curtain").addClass("show-overflow"),$("#msg").fadeIn(300),$.get("privacy-policy.html",function(a){$("#msgContent").empty().append(a).removeClass().addClass("animated zoomIn"),$(".curtain").scrollTop(0)})}),$("#link-terms").on("click",function(){$("body").addClass("no-scroll"),$(".curtain").addClass("show-overflow"),$("#msg").fadeIn(300),$.get("terms.html",function(a){$("#msgContent").empty().append(a).removeClass().addClass("animated zoomIn"),$(".curtain").scrollTop(0)})}),$("#icon-close").on("click",function(){$("#msg").fadeOut(300),$("#msgContent").removeClass().addClass("animated zoomOut"),$("body").removeClass("no-scroll")})}(window,document),function(){"use strict";function a(a){var b=parseFloat(a.fontSize),c="normal"===a.lineHeight?r*b:parseFloat(a.lineHeight);return{leading:c-b,lineHeight:c,fontSize:b}}function b(a){var b=a.createElement("div");return b.style.position="fixed",b.style.padding=q,b.style.opacity="0",b.style.fontSize=p,b.style.lineHeight="1",a.body.appendChild(b),b}function c(a){var b=a.ownerDocument.createElement("span");return b.textContent=n,a&&a.appendChild(b),b}function d(a){a.ownerDocument.body.removeChild(a)}function e(a,b,c,d){function e(a,b){var c=4*b,d=a.data[c],e=a.data[c+1],f=a.data[c+2];return 0===d||0===e||0===f}var f=-1,g=document.createElement("canvas");g.width=c,g.height=d,a.appendChild(g);var h=g.getContext("2d");h.font=p+" "+b,h.fillStyle="#ffffff",h.fillRect(0,0,h.canvas.width,h.canvas.height),h.fillStyle="#000000",h.textBaseline="top",h.fillText("E",0,0);for(var i=h.getImageData(Math.ceil(g.width/2),0,1,g.height),j=null,k=g.height-1;k>=0;k--)if(e(i,k)){j=k;break}for(var k=0;k<g.height;k++)if(e(i,k)){f=(j+1-k)/d;break}return f}function f(a,f){var g=s[f];if(g)return g;g={baselineRatio:void 0,capHeightRatio:void 0};var h=b(a);h.style.fontFamily=f;var i=c(h);i.style.fontSize=q;var j=c(h);g.baselineRatio=i.offsetTop/o;try{g.capHeightRatio=e(h,f,j.offsetWidth,o)}catch(a){throw new Error("[dropcap.js] Error computing font metrics: "+a.message)}finally{d(h)}return s[f]=g,g}function g(a){return a+"px"}function h(a){if(a.classList.contains(t))return!0}function i(a){return-1!=="gjpqQ".indexOf(a.textContent)}function j(a){a.dcapjs&&(a.style.cssFloat="",a.style.padding="",a.style.fontSize="",a.style.lineHeight="",a.style.marginTop="")}function k(b,c,d){if(d||(d=c),1==d&&1==c)return void j(b);var e=b.ownerDocument,k=b,l=k.parentNode,m=window.getComputedStyle(k),n=window.getComputedStyle(l),o=f(e,m.fontFamily),p=f(e,n.fontFamily),r=o.capHeightRatio,s=a(n),t=(p.baselineRatio-p.capHeightRatio)*s.fontSize,u=c*s.lineHeight-s.leading-t-(1-p.baselineRatio)*s.fontSize,v=u/r;k.dcapjs=!0,"rtl"==m.direction?k.style.cssFloat="right":k.style.cssFloat="left",k.style.padding=q,k.style.fontSize=g(v),k.style.lineHeight=q;var w=s.leading/2+t;if(w-=(c-d)*s.lineHeight,k.style.marginTop=g(w),c>d){var x=parseFloat(n.marginTop);l.style.marginTop=g(x+-1*w)}var y=0;i(k)?y=v*(1-o.baselineRatio):h(k)&&(y=v-u),k.style.height=g(u+y);var z=k.dcapjsStrut;z||(z=e.createElement("span"),z.style.display="inline-block",k.appendChild(z),k.dcapjsStrut=z),z.style.height=g(u)}function l(a){function b(a){return a in c.style}var c=window.document.body?window.document.body:document.createElement("div");if(b(a))return a;for(var d=["-webkit-","-moz-","-ms-","-o"],e=0;e<d.length;e++){var f=d[e]+a;if(b(f))return f}return null}var m,n="X",o=100,p=o+"px",q="0px",r=1.15,s={},t="dcjs-descender";m="undefined"!=typeof window?window:"undefined"!=typeof exports?exports:this,m.Dropcap={options:{runEvenIfInitialLetterExists:!0},layout:function(a,b,c){if(0==this.options.runEvenIfInitialLetterExists){if(l("initial-letter"))return}if(b<1||c&&c<1)throw new RangeError("Dropcap.layout expects the baseline position and height to be 1 or above");if(a instanceof HTMLElement)k(a,b,c);else{if(!(a instanceof NodeList))throw new TypeError("Dropcap.layout expects a single HTMLElement or a NodeList");Array.prototype.forEach.call(a,function(a){k(a,b,c)})}}}}(),function(a){a.fn.fitText=function(b,c){var d=b||1,e=a.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},c);return this.each(function(){var b=a(this),c=function(){b.css("font-size",Math.max(Math.min(b.width()/(10*d),parseFloat(e.maxFontSize)),parseFloat(e.minFontSize)))};c(),a(window).on("resize.fittext orientationchange.fittext",c)})}}(jQuery);var level,attempt=-1,score,userTopScore=0,outOf,multiplier,maxScore,varId=getParameterByName("id");console.log(varId);var varEmail=getParameterByName("email");console.log(varEmail);var levels=[{id:"01",iv:[1.2,500,18],cv:[1.45,500,18],piq:0,maxScore:10,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the line-height to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!0,values:[1.2,1.8,.05]},{id:"lw",name:"max-width",adjust:!1},{id:"fs",name:"font-size",adjust:!1}]},{id:"02",iv:[1.6,400,18],cv:[1.6,630,18],piq:1,maxScore:15,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the line width to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1},{id:"lw",name:"max-width",adjust:!0,values:[300,750,10]},{id:"fs",name:"font-size",adjust:!1}]},{id:"03",iv:[1.3,350,20],cv:[1.3,350,16],piq:2,maxScore:5,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the font size to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1,values:[.95,2.2,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!0,values:[11,22,1]}]},{id:"04",iv:[2,650,20],cv:[1.55,650,20],piq:0,maxScore:10,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the line-height to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!0,values:[1.3,2.2,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!1,values:[12,29,1]}]},{id:"05",iv:[1.4,750,16],cv:[1.4,500,16],piq:1,maxScore:15,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the line width to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1,values:[.95,2.2,.05]},{id:"lw",name:"max-width",adjust:!0,values:[300,1e3,10]},{id:"fs",name:"font-size",adjust:!1,values:[12,29,1]}]},{id:"06",iv:[1.85,750,29],cv:[1.85,750,23],piq:2,maxScore:5,font:"Georgia",fallbackFont:"Serif",instructions:"Adjust the font size to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1,values:[.95,2.2,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!0,values:[12,29,1]}]},{id:"07",iv:[1,750,22],cv:[1.65,750,22],piq:0,maxScore:10,font:"Merriweather",fallbackFont:"Serif",instructions:"Adjust the line-height to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!0,values:[.9,1.8,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!1,values:[12,29,1]}]},{id:"08",iv:[1.5,250,18],cv:[1.5,600,18],piq:1,maxScore:15,font:"Libre Baskerville",fallbackFont:"Serif",instructions:"Adjust the line width to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1,values:[.95,2.2,.05]},{id:"lw",name:"max-width",adjust:!0,values:[100,1e3,10]},{id:"fs",name:"font-size",adjust:!1,values:[12,29,1]}]},{id:"09",iv:[1.45,500,20],cv:[1.45,500,15],piq:2,maxScore:5,font:"Merriweather",fallbackFont:"Serif",instructions:"Adjust the font size to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!1,values:[.95,2.2,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!0,values:[10,24,1]}]},{id:"10",iv:[1.1,550,17],cv:[1.55,550,17],piq:0,maxScore:10,font:"Libre Baskerville",fallbackFont:"Serif",instructions:"Adjust the line-height to what you think best matches other parameters.",parameters:[{id:"lh",name:"line-height",adjust:!0,values:[.9,2.1,.05]},{id:"lw",name:"max-width",adjust:!1,values:[100,1e3,1]},{id:"fs",name:"font-size",adjust:!1,values:[12,29,1]}]}],numOfLevels=levels.length;$(".start").click(function(a){return a.preventDefault(),startGame(),!1}),$("#tryAgain").click(function(a){return a.preventDefault(),$(".anim").addClass("animated fadeOutUpBig"),startGame(),!1}),$("#check").click(function(a){return a.preventDefault(),checkScore(),!1}),$("#next-level").click(function(a){return a.preventDefault(),$(".anim").addClass("animated fadeOutUpBig"),loadLevel(),!1});